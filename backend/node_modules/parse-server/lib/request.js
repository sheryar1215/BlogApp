"use strict";

var _querystring = _interopRequireDefault(require("querystring"));
var _logger = _interopRequireDefault(require("./logger"));
var _followRedirects = require("follow-redirects");
var _url = require("url");
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
class HTTPResponse {
  constructor(response, body) {
    let _text, _data;
    this.status = response.statusCode;
    this.headers = response.headers || {};
    this.cookies = this.headers['set-cookie'];
    if (typeof body == 'string') {
      _text = body;
    } else if (Buffer.isBuffer(body)) {
      this.buffer = body;
    } else if (typeof body == 'object') {
      _data = body;
    }
    const getText = () => {
      if (!_text && this.buffer) {
        _text = this.buffer.toString('utf-8');
      } else if (!_text && _data) {
        _text = JSON.stringify(_data);
      }
      return _text;
    };
    const getData = () => {
      if (!_data) {
        try {
          _data = JSON.parse(getText());
        } catch (e) {
          /* */
        }
      }
      return _data;
    };
    Object.defineProperty(this, 'body', {
      get: () => {
        return body;
      }
    });
    Object.defineProperty(this, 'text', {
      enumerable: true,
      get: getText
    });
    Object.defineProperty(this, 'data', {
      enumerable: true,
      get: getData
    });
  }
}
const clients = {
  'http:': _followRedirects.http,
  'https:': _followRedirects.https
};
function makeCallback(resolve, reject) {
  return function (response) {
    const chunks = [];
    response.on('data', chunk => {
      chunks.push(chunk);
    });
    response.on('end', () => {
      const body = Buffer.concat(chunks);
      const httpResponse = new HTTPResponse(response, body);

      // Consider <200 && >= 400 as errors
      if (httpResponse.status < 200 || httpResponse.status >= 400) {
        return reject(httpResponse);
      } else {
        return resolve(httpResponse);
      }
    });
    response.on('error', reject);
  };
}
const encodeBody = function ({
  body,
  headers = {}
}) {
  if (typeof body !== 'object') {
    return {
      body,
      headers
    };
  }
  var contentTypeKeys = Object.keys(headers).filter(key => {
    return key.match(/content-type/i) != null;
  });
  if (contentTypeKeys.length == 0) {
    // no content type
    //  As per https://parse.com/docs/cloudcode/guide#cloud-code-advanced-sending-a-post-request the default encoding is supposedly x-www-form-urlencoded

    body = _querystring.default.stringify(body);
    headers['Content-Type'] = 'application/x-www-form-urlencoded';
  } else {
    /* istanbul ignore next */
    if (contentTypeKeys.length > 1) {
      _logger.default.error('Parse.Cloud.httpRequest', 'multiple content-type headers are set.');
    }
    // There maybe many, we'll just take the 1st one
    var contentType = contentTypeKeys[0];
    if (headers[contentType].match(/application\/json/i)) {
      body = JSON.stringify(body);
    } else if (headers[contentType].match(/application\/x-www-form-urlencoded/i)) {
      body = _querystring.default.stringify(body);
    }
  }
  return {
    body,
    headers
  };
};
function httpRequest(options) {
  let url;
  try {
    url = (0, _url.parse)(options.url);
  } catch (e) {
    return Promise.reject(e);
  }
  options = Object.assign(options, encodeBody(options));
  // support params options
  if (typeof options.params === 'object') {
    options.qs = options.params;
  } else if (typeof options.params === 'string') {
    options.qs = _querystring.default.parse(options.params);
  }
  const client = clients[url.protocol];
  if (!client) {
    return Promise.reject(`Unsupported protocol ${url.protocol}`);
  }
  const requestOptions = {
    method: options.method,
    port: Number(url.port),
    path: url.pathname,
    hostname: url.hostname,
    headers: options.headers,
    encoding: null,
    followRedirects: options.followRedirects === true
  };
  if (requestOptions.headers) {
    Object.keys(requestOptions.headers).forEach(key => {
      if (typeof requestOptions.headers[key] === 'undefined') {
        delete requestOptions.headers[key];
      }
    });
  }
  if (url.search) {
    options.qs = Object.assign({}, options.qs, _querystring.default.parse(url.query));
  }
  if (url.auth) {
    requestOptions.auth = url.auth;
  }
  if (options.qs) {
    requestOptions.path += `?${_querystring.default.stringify(options.qs)}`;
  }
  if (options.agent) {
    requestOptions.agent = options.agent;
  }
  return new Promise((resolve, reject) => {
    const req = client.request(requestOptions, makeCallback(resolve, reject, options));
    if (options.body) {
      req.write(options.body);
    }
    req.on('error', error => {
      reject(error);
    });
    req.end();
  });
}
module.exports = httpRequest;
module.exports.encodeBody = encodeBody;
module.exports.HTTPResponse = HTTPResponse;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcXVlcnlzdHJpbmciLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9sb2dnZXIiLCJfZm9sbG93UmVkaXJlY3RzIiwiX3VybCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkhUVFBSZXNwb25zZSIsImNvbnN0cnVjdG9yIiwicmVzcG9uc2UiLCJib2R5IiwiX3RleHQiLCJfZGF0YSIsInN0YXR1cyIsInN0YXR1c0NvZGUiLCJoZWFkZXJzIiwiY29va2llcyIsIkJ1ZmZlciIsImlzQnVmZmVyIiwiYnVmZmVyIiwiZ2V0VGV4dCIsInRvU3RyaW5nIiwiSlNPTiIsInN0cmluZ2lmeSIsImdldERhdGEiLCJwYXJzZSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0IiwiZW51bWVyYWJsZSIsImNsaWVudHMiLCJodHRwIiwiaHR0cHMiLCJtYWtlQ2FsbGJhY2siLCJyZXNvbHZlIiwicmVqZWN0IiwiY2h1bmtzIiwib24iLCJjaHVuayIsInB1c2giLCJjb25jYXQiLCJodHRwUmVzcG9uc2UiLCJlbmNvZGVCb2R5IiwiY29udGVudFR5cGVLZXlzIiwia2V5cyIsImZpbHRlciIsImtleSIsIm1hdGNoIiwibGVuZ3RoIiwicXVlcnlzdHJpbmciLCJsb2ciLCJlcnJvciIsImNvbnRlbnRUeXBlIiwiaHR0cFJlcXVlc3QiLCJvcHRpb25zIiwidXJsIiwiUHJvbWlzZSIsImFzc2lnbiIsInBhcmFtcyIsInFzIiwiY2xpZW50IiwicHJvdG9jb2wiLCJyZXF1ZXN0T3B0aW9ucyIsIm1ldGhvZCIsInBvcnQiLCJOdW1iZXIiLCJwYXRoIiwicGF0aG5hbWUiLCJob3N0bmFtZSIsImVuY29kaW5nIiwiZm9sbG93UmVkaXJlY3RzIiwiZm9yRWFjaCIsInNlYXJjaCIsInF1ZXJ5IiwiYXV0aCIsImFnZW50IiwicmVxIiwicmVxdWVzdCIsIndyaXRlIiwiZW5kIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXF1ZXN0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBxdWVyeXN0cmluZyBmcm9tICdxdWVyeXN0cmluZyc7XG5pbXBvcnQgbG9nIGZyb20gJy4vbG9nZ2VyJztcbmltcG9ydCB7IGh0dHAsIGh0dHBzIH0gZnJvbSAnZm9sbG93LXJlZGlyZWN0cyc7XG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJ3VybCc7XG5cbmNsYXNzIEhUVFBSZXNwb25zZSB7XG4gIGNvbnN0cnVjdG9yKHJlc3BvbnNlLCBib2R5KSB7XG4gICAgbGV0IF90ZXh0LCBfZGF0YTtcbiAgICB0aGlzLnN0YXR1cyA9IHJlc3BvbnNlLnN0YXR1c0NvZGU7XG4gICAgdGhpcy5oZWFkZXJzID0gcmVzcG9uc2UuaGVhZGVycyB8fCB7fTtcbiAgICB0aGlzLmNvb2tpZXMgPSB0aGlzLmhlYWRlcnNbJ3NldC1jb29raWUnXTtcblxuICAgIGlmICh0eXBlb2YgYm9keSA9PSAnc3RyaW5nJykge1xuICAgICAgX3RleHQgPSBib2R5O1xuICAgIH0gZWxzZSBpZiAoQnVmZmVyLmlzQnVmZmVyKGJvZHkpKSB7XG4gICAgICB0aGlzLmJ1ZmZlciA9IGJvZHk7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgYm9keSA9PSAnb2JqZWN0Jykge1xuICAgICAgX2RhdGEgPSBib2R5O1xuICAgIH1cblxuICAgIGNvbnN0IGdldFRleHQgPSAoKSA9PiB7XG4gICAgICBpZiAoIV90ZXh0ICYmIHRoaXMuYnVmZmVyKSB7XG4gICAgICAgIF90ZXh0ID0gdGhpcy5idWZmZXIudG9TdHJpbmcoJ3V0Zi04Jyk7XG4gICAgICB9IGVsc2UgaWYgKCFfdGV4dCAmJiBfZGF0YSkge1xuICAgICAgICBfdGV4dCA9IEpTT04uc3RyaW5naWZ5KF9kYXRhKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBfdGV4dDtcbiAgICB9O1xuXG4gICAgY29uc3QgZ2V0RGF0YSA9ICgpID0+IHtcbiAgICAgIGlmICghX2RhdGEpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBfZGF0YSA9IEpTT04ucGFyc2UoZ2V0VGV4dCgpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgIC8qICovXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBfZGF0YTtcbiAgICB9O1xuXG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsICdib2R5Jywge1xuICAgICAgZ2V0OiAoKSA9PiB7XG4gICAgICAgIHJldHVybiBib2R5O1xuICAgICAgfSxcbiAgICB9KTtcblxuICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLCAndGV4dCcsIHtcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICBnZXQ6IGdldFRleHQsXG4gICAgfSk7XG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGhpcywgJ2RhdGEnLCB7XG4gICAgICBlbnVtZXJhYmxlOiB0cnVlLFxuICAgICAgZ2V0OiBnZXREYXRhLFxuICAgIH0pO1xuICB9XG59XG5cbmNvbnN0IGNsaWVudHMgPSB7XG4gICdodHRwOic6IGh0dHAsXG4gICdodHRwczonOiBodHRwcyxcbn07XG5cbmZ1bmN0aW9uIG1ha2VDYWxsYmFjayhyZXNvbHZlLCByZWplY3QpIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgIGNvbnN0IGNodW5rcyA9IFtdO1xuICAgIHJlc3BvbnNlLm9uKCdkYXRhJywgY2h1bmsgPT4ge1xuICAgICAgY2h1bmtzLnB1c2goY2h1bmspO1xuICAgIH0pO1xuICAgIHJlc3BvbnNlLm9uKCdlbmQnLCAoKSA9PiB7XG4gICAgICBjb25zdCBib2R5ID0gQnVmZmVyLmNvbmNhdChjaHVua3MpO1xuICAgICAgY29uc3QgaHR0cFJlc3BvbnNlID0gbmV3IEhUVFBSZXNwb25zZShyZXNwb25zZSwgYm9keSk7XG5cbiAgICAgIC8vIENvbnNpZGVyIDwyMDAgJiYgPj0gNDAwIGFzIGVycm9yc1xuICAgICAgaWYgKGh0dHBSZXNwb25zZS5zdGF0dXMgPCAyMDAgfHwgaHR0cFJlc3BvbnNlLnN0YXR1cyA+PSA0MDApIHtcbiAgICAgICAgcmV0dXJuIHJlamVjdChodHRwUmVzcG9uc2UpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoaHR0cFJlc3BvbnNlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXNwb25zZS5vbignZXJyb3InLCByZWplY3QpO1xuICB9O1xufVxuXG5jb25zdCBlbmNvZGVCb2R5ID0gZnVuY3Rpb24gKHsgYm9keSwgaGVhZGVycyA9IHt9IH0pIHtcbiAgaWYgKHR5cGVvZiBib2R5ICE9PSAnb2JqZWN0Jykge1xuICAgIHJldHVybiB7IGJvZHksIGhlYWRlcnMgfTtcbiAgfVxuICB2YXIgY29udGVudFR5cGVLZXlzID0gT2JqZWN0LmtleXMoaGVhZGVycykuZmlsdGVyKGtleSA9PiB7XG4gICAgcmV0dXJuIGtleS5tYXRjaCgvY29udGVudC10eXBlL2kpICE9IG51bGw7XG4gIH0pO1xuXG4gIGlmIChjb250ZW50VHlwZUtleXMubGVuZ3RoID09IDApIHtcbiAgICAvLyBubyBjb250ZW50IHR5cGVcbiAgICAvLyAgQXMgcGVyIGh0dHBzOi8vcGFyc2UuY29tL2RvY3MvY2xvdWRjb2RlL2d1aWRlI2Nsb3VkLWNvZGUtYWR2YW5jZWQtc2VuZGluZy1hLXBvc3QtcmVxdWVzdCB0aGUgZGVmYXVsdCBlbmNvZGluZyBpcyBzdXBwb3NlZGx5IHgtd3d3LWZvcm0tdXJsZW5jb2RlZFxuXG4gICAgYm9keSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShib2R5KTtcbiAgICBoZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO1xuICB9IGVsc2Uge1xuICAgIC8qIGlzdGFuYnVsIGlnbm9yZSBuZXh0ICovXG4gICAgaWYgKGNvbnRlbnRUeXBlS2V5cy5sZW5ndGggPiAxKSB7XG4gICAgICBsb2cuZXJyb3IoJ1BhcnNlLkNsb3VkLmh0dHBSZXF1ZXN0JywgJ211bHRpcGxlIGNvbnRlbnQtdHlwZSBoZWFkZXJzIGFyZSBzZXQuJyk7XG4gICAgfVxuICAgIC8vIFRoZXJlIG1heWJlIG1hbnksIHdlJ2xsIGp1c3QgdGFrZSB0aGUgMXN0IG9uZVxuICAgIHZhciBjb250ZW50VHlwZSA9IGNvbnRlbnRUeXBlS2V5c1swXTtcbiAgICBpZiAoaGVhZGVyc1tjb250ZW50VHlwZV0ubWF0Y2goL2FwcGxpY2F0aW9uXFwvanNvbi9pKSkge1xuICAgICAgYm9keSA9IEpTT04uc3RyaW5naWZ5KGJvZHkpO1xuICAgIH0gZWxzZSBpZiAoaGVhZGVyc1tjb250ZW50VHlwZV0ubWF0Y2goL2FwcGxpY2F0aW9uXFwveC13d3ctZm9ybS11cmxlbmNvZGVkL2kpKSB7XG4gICAgICBib2R5ID0gcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGJvZHkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4geyBib2R5LCBoZWFkZXJzIH07XG59O1xuXG5mdW5jdGlvbiBodHRwUmVxdWVzdChvcHRpb25zKSB7XG4gIGxldCB1cmw7XG4gIHRyeSB7XG4gICAgdXJsID0gcGFyc2Uob3B0aW9ucy51cmwpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGUpO1xuICB9XG4gIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKG9wdGlvbnMsIGVuY29kZUJvZHkob3B0aW9ucykpO1xuICAvLyBzdXBwb3J0IHBhcmFtcyBvcHRpb25zXG4gIGlmICh0eXBlb2Ygb3B0aW9ucy5wYXJhbXMgPT09ICdvYmplY3QnKSB7XG4gICAgb3B0aW9ucy5xcyA9IG9wdGlvbnMucGFyYW1zO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBvcHRpb25zLnBhcmFtcyA9PT0gJ3N0cmluZycpIHtcbiAgICBvcHRpb25zLnFzID0gcXVlcnlzdHJpbmcucGFyc2Uob3B0aW9ucy5wYXJhbXMpO1xuICB9XG4gIGNvbnN0IGNsaWVudCA9IGNsaWVudHNbdXJsLnByb3RvY29sXTtcbiAgaWYgKCFjbGllbnQpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYFVuc3VwcG9ydGVkIHByb3RvY29sICR7dXJsLnByb3RvY29sfWApO1xuICB9XG4gIGNvbnN0IHJlcXVlc3RPcHRpb25zID0ge1xuICAgIG1ldGhvZDogb3B0aW9ucy5tZXRob2QsXG4gICAgcG9ydDogTnVtYmVyKHVybC5wb3J0KSxcbiAgICBwYXRoOiB1cmwucGF0aG5hbWUsXG4gICAgaG9zdG5hbWU6IHVybC5ob3N0bmFtZSxcbiAgICBoZWFkZXJzOiBvcHRpb25zLmhlYWRlcnMsXG4gICAgZW5jb2Rpbmc6IG51bGwsXG4gICAgZm9sbG93UmVkaXJlY3RzOiBvcHRpb25zLmZvbGxvd1JlZGlyZWN0cyA9PT0gdHJ1ZSxcbiAgfTtcbiAgaWYgKHJlcXVlc3RPcHRpb25zLmhlYWRlcnMpIHtcbiAgICBPYmplY3Qua2V5cyhyZXF1ZXN0T3B0aW9ucy5oZWFkZXJzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICBpZiAodHlwZW9mIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNba2V5XSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgZGVsZXRlIHJlcXVlc3RPcHRpb25zLmhlYWRlcnNba2V5XTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICBpZiAodXJsLnNlYXJjaCkge1xuICAgIG9wdGlvbnMucXMgPSBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLnFzLCBxdWVyeXN0cmluZy5wYXJzZSh1cmwucXVlcnkpKTtcbiAgfVxuICBpZiAodXJsLmF1dGgpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5hdXRoID0gdXJsLmF1dGg7XG4gIH1cbiAgaWYgKG9wdGlvbnMucXMpIHtcbiAgICByZXF1ZXN0T3B0aW9ucy5wYXRoICs9IGA/JHtxdWVyeXN0cmluZy5zdHJpbmdpZnkob3B0aW9ucy5xcyl9YDtcbiAgfVxuICBpZiAob3B0aW9ucy5hZ2VudCkge1xuICAgIHJlcXVlc3RPcHRpb25zLmFnZW50ID0gb3B0aW9ucy5hZ2VudDtcbiAgfVxuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IHJlcSA9IGNsaWVudC5yZXF1ZXN0KHJlcXVlc3RPcHRpb25zLCBtYWtlQ2FsbGJhY2socmVzb2x2ZSwgcmVqZWN0LCBvcHRpb25zKSk7XG4gICAgaWYgKG9wdGlvbnMuYm9keSkge1xuICAgICAgcmVxLndyaXRlKG9wdGlvbnMuYm9keSk7XG4gICAgfVxuICAgIHJlcS5vbignZXJyb3InLCBlcnJvciA9PiB7XG4gICAgICByZWplY3QoZXJyb3IpO1xuICAgIH0pO1xuICAgIHJlcS5lbmQoKTtcbiAgfSk7XG59XG5tb2R1bGUuZXhwb3J0cyA9IGh0dHBSZXF1ZXN0O1xubW9kdWxlLmV4cG9ydHMuZW5jb2RlQm9keSA9IGVuY29kZUJvZHk7XG5tb2R1bGUuZXhwb3J0cy5IVFRQUmVzcG9uc2UgPSBIVFRQUmVzcG9uc2U7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsWUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsZ0JBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLElBQUEsR0FBQUgsT0FBQTtBQUE0QixTQUFBRCx1QkFBQUssQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUU1QixNQUFNRyxZQUFZLENBQUM7RUFDakJDLFdBQVdBLENBQUNDLFFBQVEsRUFBRUMsSUFBSSxFQUFFO0lBQzFCLElBQUlDLEtBQUssRUFBRUMsS0FBSztJQUNoQixJQUFJLENBQUNDLE1BQU0sR0FBR0osUUFBUSxDQUFDSyxVQUFVO0lBQ2pDLElBQUksQ0FBQ0MsT0FBTyxHQUFHTixRQUFRLENBQUNNLE9BQU8sSUFBSSxDQUFDLENBQUM7SUFDckMsSUFBSSxDQUFDQyxPQUFPLEdBQUcsSUFBSSxDQUFDRCxPQUFPLENBQUMsWUFBWSxDQUFDO0lBRXpDLElBQUksT0FBT0wsSUFBSSxJQUFJLFFBQVEsRUFBRTtNQUMzQkMsS0FBSyxHQUFHRCxJQUFJ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