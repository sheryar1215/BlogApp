"use strict";

var https = require('https'),
  crypto = require('crypto');
var Parse = require('parse/node').Parse;
var OAuth = function (options) {
  if (!options) {
    throw new Parse.Error(Parse.Error.INTERNAL_SERVER_ERROR, 'No options passed to OAuth');
  }
  this.consumer_key = options.consumer_key;
  this.consumer_secret = options.consumer_secret;
  this.auth_token = options.auth_token;
  this.auth_token_secret = options.auth_token_secret;
  this.host = options.host;
  this.oauth_params = options.oauth_params || {};
};
OAuth.prototype.send = function (method, path, params, body) {
  var request = this.buildRequest(method, path, params, body);
  // Encode the body properly, the current Parse Implementation don't do it properly
  return new Promise(function (resolve, reject) {
    var httpRequest = https.request(request, function (res) {
      var data = '';
      res.on('data', function (chunk) {
        data += chunk;
      });
      res.on('end', function () {
        data = JSON.parse(data);
        resolve(data);
      });
    }).on('error', function () {
      reject('Failed to make an OAuth request');
    });
    if (request.body) {
      httpRequest.write(request.body);
    }
    httpRequest.end();
  });
};
OAuth.prototype.buildRequest = function (method, path, params, body) {
  if (path.indexOf('/') != 0) {
    path = '/' + path;
  }
  if (params && Object.keys(params).length > 0) {
    path += '?' + OAuth.buildParameterString(params);
  }
  var request = {
    host: this.host,
    path: path,
    method: method.toUpperCase()
  };
  var oauth_params = this.oauth_params || {};
  oauth_params.oauth_consumer_key = this.consumer_key;
  if (this.auth_token) {
    oauth_params['oauth_token'] = this.auth_token;
  }
  request = OAuth.signRequest(request, oauth_params, this.consumer_secret, this.auth_token_secret);
  if (body && Object.keys(body).length > 0) {
    request.body = OAuth.buildParameterString(body);
  }
  return request;
};
OAuth.prototype.get = function (path, params) {
  return this.send('GET', path, params);
};
OAuth.prototype.post = function (path, params, body) {
  return this.send('POST', path, params, body);
};

/*
	Proper string %escape encoding
*/
OAuth.encode = function (str) {
  //       discuss at: http://phpjs.org/functions/rawurlencode/
  //      original by: Brett Zamir (http://brett-zamir.me)
  //         input by: travc
  //         input by: Brett Zamir (http://brett-zamir.me)
  //         input by: Michael Grier
  //         input by: Ratheous
  //      bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)
  //      bugfixed by: Brett Zamir (http://brett-zamir.me)
  //      bugfixed by: Joris
  // reimplemented by: Brett Zamir (http://brett-zamir.me)
  // reimplemented by: Brett Zamir (http://brett-zamir.me)
  //             note: This reflects PHP 5.3/6.0+ behavior
  //             note: Please be aware that this function expects to encode into UTF-8 encoded strings, as found on
  //             note: pages served as UTF-8
  //        example 1: rawurlencode('Kevin van Zonneveld!');
  //        returns 1: 'Kevin%20van%20Zonneveld%21'
  //        example 2: rawurlencode('http://kevin.vanzonneveld.net/');
  //        returns 2: 'http%3A%2F%2Fkevin.vanzonneveld.net%2F'
  //        example 3: rawurlencode('http://www.google.nl/search?q=php.js&ie=utf-8&oe=utf-8&aq=t&rls=com.ubuntu:en-US:unofficial&client=firefox-a');
  //        returns 3: 'http%3A%2F%2Fwww.google.nl%2Fsearch%3Fq%3Dphp.js%26ie%3Dutf-8%26oe%3Dutf-8%26aq%3Dt%26rls%3Dcom.ubuntu%3Aen-US%3Aunofficial%26client%3Dfirefox-a'

  str = (str + '').toString();

  // Tilde should be allowed unescaped in future versions of PHP (as reflected below), but if you want to reflect current
  // PHP behavior, you would need to add ".replace(/~/g, '%7E');" to the following.
  return encodeURIComponent(str).replace(/!/g, '%21').replace(/'/g, '%27').replace(/\(/g, '%28').replace(/\)/g, '%29').replace(/\*/g, '%2A');
};
OAuth.signatureMethod = 'HMAC-SHA1';
OAuth.version = '1.0';

/*
	Generate a nonce
*/
OAuth.nonce = function () {
  var text = '';
  var possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
  for (var i = 0; i < 30; i++) {
    text += possible.charAt(Math.floor(Math.random() * possible.length));
  }
  return text;
};
OAuth.buildParameterString = function (obj) {
  // Sort keys and encode values
  if (obj) {
    var keys = Object.keys(obj).sort();

    // Map key=value, join them by &
    return keys.map(function (key) {
      return key + '=' + OAuth.encode(obj[key]);
    }).join('&');
  }
  return '';
};

/*
	Build the signature string from the object
*/

OAuth.buildSignatureString = function (method, url, parameters) {
  return [method.toUpperCase(), OAuth.encode(url), OAuth.encode(parameters)].join('&');
};

/*
	Retuns encoded HMAC-SHA1 from key and text
*/
OAuth.signature = function (text, key) {
  crypto = require('crypto');
  return OAuth.encode(crypto.createHmac('sha1', key).update(text).digest('base64'));
};
OAuth.signRequest = function (request, oauth_parameters, consumer_secret, auth_token_secret) {
  oauth_parameters = oauth_parameters || {};

  // Set default values
  if (!oauth_parameters.oauth_nonce) {
    oauth_parameters.oauth_nonce = OAuth.nonce();
  }
  if (!oauth_parameters.oauth_timestamp) {
    oauth_parameters.oauth_timestamp = Math.floor(new Date().getTime() / 1000);
  }
  if (!oauth_parameters.oauth_signature_method) {
    oauth_parameters.oauth_signature_method = OAuth.signatureMethod;
  }
  if (!oauth_parameters.oauth_version) {
    oauth_parameters.oauth_version = OAuth.version;
  }
  if (!auth_token_secret) {
    auth_token_secret = '';
  }
  // Force GET method if unset
  if (!request.method) {
    request.method = 'GET';
  }

  // Collect  all the parameters in one signatureParameters object
  var signatureParams = {};
  var parametersToMerge = [request.params, request.body, oauth_parameters];
  for (var i in parametersToMerge) {
    var parameters = parametersToMerge[i];
    for (var k in parameters) {
      signatureParams[k] = parameters[k];
    }
  }

  // Create a string based on the parameters
  var parameterString = OAuth.buildParameterString(signatureParams);

  // Build the signature string
  var url = 'https://' + request.host + '' + request.path;
  var signatureString = OAuth.buildSignatureString(request.method, url, parameterString);
  // Hash the signature string
  var signatureKey = [OAuth.encode(consumer_secret), OAuth.encode(auth_token_secret)].join('&');
  var signature = OAuth.signature(signatureString, signatureKey);

  // Set the signature in the params
  oauth_parameters.oauth_signature = signature;
  if (!request.headers) {
    request.headers = {};
  }

  // Set the authorization header
  var authHeader = Object.keys(oauth_parameters).sort().map(function (key) {
    var value = oauth_parameters[key];
    return key + '="' + value + '"';
  }).join(', ');
  request.headers.Authorization = 'OAuth ' + authHeader;

  // Set the content type header
  request.headers['Content-Type'] = 'application/x-www-form-urlencoded';
  return request;
};
module.exports = OAuth;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJodHRwcyIsInJlcXVpcmUiLCJjcnlwdG8iLCJQYXJzZSIsIk9BdXRoIiwib3B0aW9ucyIsIkVycm9yIiwiSU5URVJOQUxfU0VSVkVSX0VSUk9SIiwiY29uc3VtZXJfa2V5IiwiY29uc3VtZXJfc2VjcmV0IiwiYXV0aF90b2tlbiIsImF1dGhfdG9rZW5fc2VjcmV0IiwiaG9zdCIsIm9hdXRoX3BhcmFtcyIsInByb3RvdHlwZSIsInNlbmQiLCJtZXRob2QiLCJwYXRoIiwicGFyYW1zIiwiYm9keSIsInJlcXVlc3QiLCJidWlsZFJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImh0dHBSZXF1ZXN0IiwicmVzIiwiZGF0YSIsIm9uIiwiY2h1bmsiLCJKU09OIiwicGFyc2UiLCJ3cml0ZSIsImVuZCIsImluZGV4T2YiLCJPYmplY3QiLCJrZXlzIiwibGVuZ3RoIiwiYnVpbGRQYXJhbWV0ZXJTdHJpbmciLCJ0b1VwcGVyQ2FzZSIsIm9hdXRoX2NvbnN1bWVyX2tleSIsInNpZ25SZXF1ZXN0IiwiZ2V0IiwicG9zdCIsImVuY29kZSIsInN0ciIsInRvU3RyaW5nIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwicmVwbGFjZSIsInNpZ25hdHVyZU1ldGhvZCIsInZlcnNpb24iLCJub25jZSIsInRleHQiLCJwb3NzaWJsZSIsImkiLCJjaGFyQXQiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJvYmoiLCJzb3J0IiwibWFwIiwia2V5Iiwiam9pbiIsImJ1aWxkU2lnbmF0dXJlU3RyaW5nIiwidXJsIiwicGFyYW1ldGVycyIsInNpZ25hdHVyZSIsImNyZWF0ZUhtYWMiLCJ1cGRhdGUiLCJkaWdlc3QiLCJvYXV0aF9wYXJhbWV0ZXJzIiwib2F1dGhfbm9uY2UiLCJvYXV0aF90aW1lc3RhbXAiLCJEYXRlIiwiZ2V0VGltZSIsIm9hdXRoX3NpZ25hdHVyZV9tZXRob2QiLCJvYXV0aF92ZXJzaW9uIiwic2lnbmF0dXJlUGFyYW1zIiwicGFyYW1ldGVyc1RvTWVyZ2UiLCJrIiwicGFyYW1ldGVyU3RyaW5nIiwic2lnbmF0dXJlU3RyaW5nIiwic2lnbmF0dXJlS2V5Iiwib2F1dGhfc2lnbmF0dXJlIiwiaGVhZGVycyIsImF1dGhIZWFkZXIiLCJ2YWx1ZSIsIkF1dGhvcml6YXRpb24iLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL0FkYXB0ZXJzL0F1dGgvT0F1dGgxQ2xpZW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbInZhciBodHRwcyA9IHJlcXVpcmUoJ2h0dHBzJyksXG4gIGNyeXB0byA9IHJlcXVpcmUoJ2NyeXB0bycpO1xudmFyIFBhcnNlID0gcmVxdWlyZSgncGFyc2Uvbm9kZScpLlBhcnNlO1xuXG52YXIgT0F1dGggPSBmdW5jdGlvbiAob3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMpIHtcbiAgICB0aHJvdyBuZXcgUGFyc2UuRXJyb3IoUGFyc2UuRXJyb3IuSU5URVJOQUxfU0VSVkVSX0VSUk9SLCAnTm8gb3B0aW9ucyBwYXNzZWQgdG8gT0F1dGgnKTtcbiAgfVxuICB0aGlzLmNvbnN1bWVyX2tleSA9IG9wdGlvbnMuY29uc3VtZXJfa2V5O1xuICB0aGlzLmNvbnN1bWVyX3NlY3JldCA9IG9wdGlvbnMuY29uc3VtZXJfc2VjcmV0O1xuICB0aGlzLmF1dGhfdG9rZW4gPSBvcHRpb25zLmF1dGhfdG9rZW47XG4gIHRoaXMuYXV0aF90b2tlbl9zZWNyZXQgPSBvcHRpb25zLmF1dGhfdG9rZW5fc2VjcmV0O1xuICB0aGlzLmhvc3QgPSBvcHRpb25zLmhvc3Q7XG4gIHRoaXMub2F1dGhfcGFyYW1zID0gb3B0aW9ucy5vYXV0aF9wYXJhbXMgfHwge307XG59O1xuXG5PQXV0aC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uIChtZXRob2QsIHBhdGgsIHBhcmFtcywgYm9keSkge1xuICB2YXIgcmVxdWVzdCA9IHRoaXMuYnVpbGRSZXF1ZXN0KG1ldGhvZCwgcGF0aCwgcGFyYW1zLCBib2R5KTtcbiAgLy8gRW5jb2RlIHRoZSBib2R5IHByb3Blcmx5LCB0aGUgY3VycmVudCBQYXJzZSBJbXBsZW1lbnRhdGlvbiBkb24ndCBkbyBpdCBwcm9wZXJseVxuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciBodHRwUmVxdWVzdCA9IGh0dHBzXG4gICAgICAucmVxdWVzdChyZXF1ZXN0LCBmdW5jdGlvbiAocmVzKSB7XG4gICAgICAgIHZhciBkYXRhID0gJyc7XG4gICAgICAgIHJlcy5vbignZGF0YScsIGZ1bmN0aW9uIChjaHVuaykge1xuICAgICAgICAgIGRhdGEgKz0gY2h1bms7XG4gICAgICAgIH0pO1xuICAgICAgICByZXMub24oJ2VuZCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgICAgICByZXNvbHZlKGRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgIH0pXG4gICAgICAub24oJ2Vycm9yJywgZnVuY3Rpb24gKCkge1xuICAgICAgICByZWplY3QoJ0ZhaWxlZCB0byBtYWtlIGFuIE9BdXRoIHJlcXVlc3QnKTtcbiAgICAgIH0pO1xuICAgIGlmIChyZXF1ZXN0LmJvZHkpIHtcbiAgICAgIGh0dHBSZXF1ZXN0LndyaXRlKHJlcXVlc3QuYm9keSk7XG4gICAgfVxuICAgIGh0dHBSZXF1ZXN0LmVuZCgpO1xuICB9KTtcbn07XG5cbk9BdXRoLnByb3RvdHlwZS5idWlsZFJlcXVlc3QgPSBmdW5jdGlvbiAobWV0aG9kLCBwYXRoLCBwYXJhbXMsIGJvZHkpIHtcbiAgaWYgKHBhdGguaW5kZXhPZignLycpICE9IDApIHtcbiAgICBwYXRoID0gJy8nICsgcGF0aDtcbiAgfVxuICBpZiAocGFyYW1zICYmIE9iamVjdC5rZXlzKHBhcmFtcykubGVuZ3RoID4gMCkge1xuICAgIHBhdGggKz0gJz8nICsgT0F1dGguYnVpbGRQYXJhbWV0ZXJTdHJpbmcocGFyYW1zKTtcbiAgfVxuXG4gIHZhciByZXF1ZXN0ID0ge1xuICAgIGhvc3Q6IHRoaXMuaG9zdCxcbiAgICBwYXRoOiBwYXRoLFxuICAgIG1ldGhvZDogbWV0aG9kLnRvVXBwZXJDYXNlKCksXG4gIH07XG5cbiAgdmFyIG9hdXRoX3BhcmFtcyA9IHRoaXMub2F1dGhfcGFyYW1zIHx8IHt9O1xuICBvYXV0aF9wYXJhbXMub2F1dGhfY29uc3VtZXJfa2V5ID0gdGhpcy5jb25zdW1lcl9rZXk7XG4gIGlmICh0aGlzLmF1dGhfdG9rZW4pIHtcbiAgICBvYXV0aF9wYXJhbXNbJ29hdXRoX3Rva2VuJ10gPSB0aGlzLmF1dGhfdG9rZW47XG4gIH1cblxuICByZXF1ZXN0ID0gT0F1dGguc2lnblJlcXVlc3QocmVxdWVzdCwgb2F1dGhfcGFyYW1zLCB0aGlzLmNvbnN1bWVyX3NlY3JldCwgdGhpcy5hdXRoX3Rva2VuX3NlY3JldCk7XG5cbiAgaWYgKGJvZHkgJiYgT2JqZWN0LmtleXMoYm9keSkubGVuZ3RoID4gMCkge1xuICAgIHJlcXVlc3QuYm9keSA9IE9BdXRoLmJ1aWxkUGFyYW1ldGVyU3RyaW5nKGJvZHkpO1xuICB9XG4gIHJldHVybiByZXF1ZXN0O1xufTtcblxuT0F1dGgucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uIChwYXRoLCBwYXJhbXMpIHtcbiAgcmV0dXJuIHRoaXMuc2VuZCgnR0VUJywgcGF0aCwgcGFyYW1zKTtcbn07XG5cbk9BdXRoLnByb3RvdHlwZS5wb3N0ID0gZnVuY3Rpb24gKHBhdGgsIHBhcmFtcywgYm9keSkge1xuICByZXR1cm4gdGhpcy5zZW5kKCdQT1NUJywgcGF0aCwgcGFyYW1zLCBib2R5KTtcbn07XG5cbi8qXG5cdFByb3BlciBzdHJpbmcgJWVzY2FwZSBlbmNvZGluZ1xuKi9cbk9BdXRoLmVuY29kZSA9IGZ1bmN0aW9uIChzdHIpIHtcbiAgLy8gICAgICAgZGlzY3VzcyBhdDogaHR0cDovL3BocGpzLm9yZy9mdW5jdGlvbnMvcmF3dXJsZW5jb2RlL1xuICAvLyAgICAgIG9yaWdpbmFsIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuICAvLyAgICAgICAgIGlucHV0IGJ5OiB0cmF2Y1xuICAvLyAgICAgICAgIGlucHV0IGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuICAvLyAgICAgICAgIGlucHV0IGJ5OiBNaWNoYWVsIEdyaWVyXG4gIC8vICAgICAgICAgaW5wdXQgYnk6IFJhdGhlb3VzXG4gIC8vICAgICAgYnVnZml4ZWQgYnk6IEtldmluIHZhbiBab25uZXZlbGQgKGh0dHA6Ly9rZXZpbi52YW56b25uZXZlbGQubmV0KVxuICAvLyAgICAgIGJ1Z2ZpeGVkIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuICAvLyAgICAgIGJ1Z2ZpeGVkIGJ5OiBKb3Jpc1xuICAvLyByZWltcGxlbWVudGVkIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuICAvLyByZWltcGxlbWVudGVkIGJ5OiBCcmV0dCBaYW1pciAoaHR0cDovL2JyZXR0LXphbWlyLm1lKVxuICAvLyAgICAgICAgICAgICBub3RlOiBUaGlzIHJlZmxlY3RzIFBIUCA1LjMvNi4wKyBiZWhhdmlvclxuICAvLyAgICAgICAgICAgICBub3RlOiBQbGVhc2UgYmUgYXdhcmUgdGhhdCB0aGlzIGZ1bmN0aW9uIGV4cGVjdHMgdG8gZW5jb2RlIGludG8gVVRGLTggZW5jb2RlZCBzdHJpbmdzLCBhcyBmb3VuZCBvblxuICAvLyAgICAgICAgICAgICBub3RlOiBwYWdlcyBzZXJ2ZWQgYXMgVVRGLThcbiAgLy8gICAgICAgIGV4YW1wbGUgMTogcmF3dXJsZW5jb2RlKCdLZXZpbiB2YW4gWm9ubmV2ZWxkIScpO1xuICAvLyAgICAgICAgcmV0dXJucyAxOiAnS2V2aW4lMjB2YW4lMjBab25uZXZlbGQlMjEnXG4gIC8vICAgICAgICBleGFtcGxlIDI6IHJhd3VybGVuY29kZSgnaHR0cDovL2tldmluLnZhbnpvbm5ldmVsZC5uZXQvJyk7XG4gIC8vICAgICAgICByZXR1cm5zIDI6ICdodHRwJTNBJTJGJTJGa2V2aW4udmFuem9ubmV2ZWxkLm5ldCUyRidcbiAgLy8gICAgICAgIGV4YW1wbGUgMzogcmF3dXJsZW5jb2RlKCdodHRwOi8vd3d3Lmdvb2dsZS5ubC9zZWFyY2g/cT1waHAuanMmaWU9dXRmLTgmb2U9dXRmLTgmYXE9dCZybHM9Y29tLnVidW50dTplbi1VUzp1bm9mZmljaWFsJmNsaWVudD1maXJlZm94LWEnKTtcbiAgLy8gICAgICAgIHJldHVybnMgMzogJ2h0dHAlM0ElMkYlMkZ3d3cuZ29vZ2xlLm5sJTJGc2VhcmNoJTNGcSUzRHBocC5qcyUyNmllJTNEdXRmLTglMjZvZSUzRHV0Zi04JTI2YXElM0R0JTI2cmxzJTNEY29tLnVidW50dSUzQWVuLVVTJTNBdW5vZmZpY2lhbCUyNmNsaWVudCUzRGZpcmVmb3gtYSdcblxuICBzdHIgPSAoc3RyICsgJycpLnRvU3RyaW5nKCk7XG5cbiAgLy8gVGlsZGUgc2hvdWxkIGJlIGFsbG93ZWQgdW5lc2NhcGVkIGluIGZ1dHVyZSB2ZXJzaW9ucyBvZiBQSFAgKGFzIHJlZmxlY3RlZCBiZWxvdyksIGJ1dCBpZiB5b3Ugd2FudCB0byByZWZsZWN0IGN1cnJlbnRcbiAgLy8gUEhQIGJlaGF2aW9yLCB5b3Ugd291bGQgbmVlZCB0byBhZGQgXCIucmVwbGFjZSgvfi9nLCAnJTdFJyk7XCIgdG8gdGhlIGZvbGxvd2luZy5cbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudChzdHIpXG4gICAgLnJlcGxhY2UoLyEvZywgJyUyMScpXG4gICAgLnJlcGxhY2UoLycvZywgJyUyNycpXG4gICAgLnJlcGxhY2UoL1xcKC9nLCAnJTI4JylcbiAgICAucmVwbGFjZSgvXFwpL2csICclMjknKVxuICAgIC5yZXBsYWNlKC9cXCovZywgJyUyQScpO1xufTtcblxuT0F1dGguc2lnbmF0dXJlTWV0aG9kID0gJ0hNQUMtU0hBMSc7XG5PQXV0aC52ZXJzaW9uID0gJzEuMCc7XG5cbi8qXG5cdEdlbmVyYXRlIGEgbm9uY2VcbiovXG5PQXV0aC5ub25jZSA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRleHQgPSAnJztcbiAgdmFyIHBvc3NpYmxlID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5JztcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IDMwOyBpKyspIHsgdGV4dCArPSBwb3NzaWJsZS5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogcG9zc2libGUubGVuZ3RoKSk7IH1cblxuICByZXR1cm4gdGV4dDtcbn07XG5cbk9BdXRoLmJ1aWxkUGFyYW1ldGVyU3RyaW5nID0gZnVuY3Rpb24gKG9iaikge1xuICAvLyBTb3J0IGtleXMgYW5kIGVuY29kZSB2YWx1ZXNcbiAgaWYgKG9iaikge1xuICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMob2JqKS5zb3J0KCk7XG5cbiAgICAvLyBNYXAga2V5PXZhbHVlLCBqb2luIHRoZW0gYnkgJlxuICAgIHJldHVybiBrZXlzXG4gICAgICAubWFwKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgICAgcmV0dXJuIGtleSArICc9JyArIE9BdXRoLmVuY29kZShvYmpba2V5XSk7XG4gICAgICB9KVxuICAgICAgLmpvaW4oJyYnKTtcbiAgfVxuXG4gIHJldHVybiAnJztcbn07XG5cbi8qXG5cdEJ1aWxkIHRoZSBzaWduYXR1cmUgc3RyaW5nIGZyb20gdGhlIG9iamVjdFxuKi9cblxuT0F1dGguYnVpbGRTaWduYXR1cmVTdHJpbmcgPSBmdW5jdGlvbiAobWV0aG9kLCB1cmwsIHBhcmFtZXRlcnMpIHtcbiAgcmV0dXJuIFttZXRob2QudG9VcHBlckNhc2UoKSwgT0F1dGguZW5jb2RlKHVybCksIE9BdXRoLmVuY29kZShwYXJhbWV0ZXJzKV0uam9pbignJicpO1xufTtcblxuLypcblx0UmV0dW5zIGVuY29kZWQgSE1BQy1TSEExIGZyb20ga2V5IGFuZCB0ZXh0XG4qL1xuT0F1dGguc2lnbmF0dXJlID0gZnVuY3Rpb24gKHRleHQsIGtleSkge1xuICBjcnlwdG8gPSByZXF1aXJlKCdjcnlwdG8nKTtcbiAgcmV0dXJuIE9BdXRoLmVuY29kZShjcnlwdG8uY3JlYXRlSG1hYygnc2hhMScsIGtleSkudXBkYXRlKHRleHQpLmRpZ2VzdCgnYmFzZTY0JykpO1xufTtcblxuT0F1dGguc2lnblJlcXVlc3QgPSBmdW5jdGlvbiAocmVxdWVzdCwgb2F1dGhfcGFyYW1ldGVycywgY29uc3VtZXJfc2VjcmV0LCBhdXRoX3Rva2VuX3NlY3JldCkge1xuICBvYXV0aF9wYXJhbWV0ZXJzID0gb2F1dGhfcGFyYW1ldGVycyB8fCB7fTtcblxuICAvLyBTZXQgZGVmYXVsdCB2YWx1ZXNcbiAgaWYgKCFvYXV0aF9wYXJhbWV0ZXJzLm9hdXRoX25vbmNlKSB7XG4gICAgb2F1dGhfcGFyYW1ldGVycy5vYXV0aF9ub25jZSA9IE9BdXRoLm5vbmNlKCk7XG4gIH1cbiAgaWYgKCFvYXV0aF9wYXJhbWV0ZXJzLm9hdXRoX3RpbWVzdGFtcCkge1xuICAgIG9hdXRoX3BhcmFtZXRlcnMub2F1dGhfdGltZXN0YW1wID0gTWF0aC5mbG9vcihuZXcgRGF0ZSgpLmdldFRpbWUoKSAvIDEwMDApO1xuICB9XG4gIGlmICghb2F1dGhfcGFyYW1ldGVycy5vYXV0aF9zaWduYXR1cmVfbWV0aG9kKSB7XG4gICAgb2F1dGhfcGFyYW1ldGVycy5vYXV0aF9zaWduYXR1cmVfbWV0aG9kID0gT0F1dGguc2lnbmF0dXJlTWV0aG9kO1xuICB9XG4gIGlmICghb2F1dGhfcGFyYW1ldGVycy5vYXV0aF92ZXJzaW9uKSB7XG4gICAgb2F1dGhfcGFyYW1ldGVycy5vYXV0aF92ZXJzaW9uID0gT0F1dGgudmVyc2lvbjtcbiAgfVxuXG4gIGlmICghYXV0aF90b2tlbl9zZWNyZXQpIHtcbiAgICBhdXRoX3Rva2VuX3NlY3JldCA9ICcnO1xuICB9XG4gIC8vIEZvcmNlIEdFVCBtZXRob2QgaWYgdW5zZXRcbiAgaWYgKCFyZXF1ZXN0Lm1ldGhvZCkge1xuICAgIHJlcXVlc3QubWV0aG9kID0gJ0dFVCc7XG4gIH1cblxuICAvLyBDb2xsZWN0ICBhbGwgdGhlIHBhcmFtZXRlcnMgaW4gb25lIHNpZ25hdHVyZVBhcmFtZXRlcnMgb2JqZWN0XG4gIHZhciBzaWduYXR1cmVQYXJhbXMgPSB7fTtcbiAgdmFyIHBhcmFtZXRlcnNUb01lcmdlID0gW3JlcXVlc3QucGFyYW1zLCByZXF1ZXN0LmJvZHksIG9hdXRoX3BhcmFtZXRlcnNdO1xuICBmb3IgKHZhciBpIGluIHBhcmFtZXRlcnNUb01lcmdlKSB7XG4gICAgdmFyIHBhcmFtZXRlcnMgPSBwYXJhbWV0ZXJzVG9NZXJnZVtpXTtcbiAgICBmb3IgKHZhciBrIGluIHBhcmFtZXRlcnMpIHtcbiAgICAgIHNpZ25hdHVyZVBhcmFtc1trXSA9IHBhcmFtZXRlcnNba107XG4gICAgfVxuICB9XG5cbiAgLy8gQ3JlYXRlIGEgc3RyaW5nIGJhc2VkIG9uIHRoZSBwYXJhbWV0ZXJzXG4gIHZhciBwYXJhbWV0ZXJTdHJpbmcgPSBPQXV0aC5idWlsZFBhcmFtZXRlclN0cmluZyhzaWduYXR1cmVQYXJhbXMpO1xuXG4gIC8vIEJ1aWxkIHRoZSBzaWduYXR1cmUgc3RyaW5nXG4gIHZhciB1cmwgPSAnaHR0cHM6Ly8nICsgcmVxdWVzdC5ob3N0ICsgJycgKyByZXF1ZXN0LnBhdGg7XG5cbiAgdmFyIHNpZ25hdHVyZVN0cmluZyA9IE9BdXRoLmJ1aWxkU2lnbmF0dXJlU3RyaW5nKHJlcXVlc3QubWV0aG9kLCB1cmwsIHBhcmFtZXRlclN0cmluZyk7XG4gIC8vIEhhc2ggdGhlIHNpZ25hdHVyZSBzdHJpbmdcbiAgdmFyIHNpZ25hdHVyZUtleSA9IFtPQXV0aC5lbmNvZGUoY29uc3VtZXJfc2VjcmV0KSwgT0F1dGguZW5jb2RlKGF1dGhfdG9rZW5fc2VjcmV0KV0uam9pbignJicpO1xuXG4gIHZhciBzaWduYXR1cmUgPSBPQXV0aC5zaWduYXR1cmUoc2lnbmF0dXJlU3RyaW5nLCBzaWduYXR1cmVLZXkpO1xuXG4gIC8vIFNldCB0aGUgc2lnbmF0dXJlIGluIHRoZSBwYXJhbXNcbiAgb2F1dGhfcGFyYW1ldGVycy5vYXV0aF9zaWduYXR1cmUgPSBzaWduYXR1cmU7XG4gIGlmICghcmVxdWVzdC5oZWFkZXJzKSB7XG4gICAgcmVxdWVzdC5oZWFkZXJzID0ge307XG4gIH1cblxuICAvLyBTZXQgdGhlIGF1dGhvcml6YXRpb24gaGVhZGVyXG4gIHZhciBhdXRoSGVhZGVyID0gT2JqZWN0LmtleXMob2F1dGhfcGFyYW1ldGVycylcbiAgICAuc29ydCgpXG4gICAgLm1hcChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgdmFsdWUgPSBvYXV0aF9wYXJhbWV0ZXJzW2tleV07XG4gICAgICByZXR1cm4ga2V5ICsgJz1cIicgKyB2YWx1ZSArICdcIic7XG4gICAgfSlcbiAgICAuam9pbignLCAnKTtcblxuICByZXF1ZXN0LmhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdPQXV0aCAnICsgYXV0aEhlYWRlcjtcblxuICAvLyBTZXQgdGhlIGNvbnRlbnQgdHlwZSBoZWFkZXJcbiAgcmVxdWVzdC5oZWFkZXJzWydDb250ZW50LVR5cGUnXSA9ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQnO1xuICByZXR1cm4gcmVxdWVzdDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gT0F1dGg7XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBSUEsS0FBSyxHQUFHQyxPQUFPLENBQUMsT0FBTyxDQUFDO0VBQzFCQyxNQUFNLEdBQUdELE9BQU8sQ0FBQyxRQUFRLENBQUM7QUFDNUIsSUFBSUUsS0FBSyxHQUFHRixPQUFPLENBQUMsWUFBWSxDQUFDLENBQUNFLEtBQUs7QUFFdkMsSUFBSUMsS0FBSyxHQUFHLFNBQUFBLENBQVVDLE9BQU8sRUFBRTtFQUM3QixJQUFJLENBQUNBLE9BQU8sRUFBRTtJQUNaLE1BQU0sSUFBSUYsS0FBSyxDQUFDRyxLQUFLLENBQUNILEtBQUssQ0FBQ0csS0FBSyxDQUFDQyxxQkFBcUIsRUFBRSw0QkFBNEIsQ0FBQztFQUN4RjtFQUNBLElBQUksQ0FBQ0MsWUFBWSxHQUFHSCxPQUFPLENBQUNHLFlBQVk7RUFDeEMsSUFBSSxDQUFDQyxl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